// backend/src/entities/flight.entity.ts = ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ Entity ‡∏Ç‡∏≠‡∏á Flight (‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô) ‡πÄ‡∏õ‡πá‡∏ô
//‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÇ‡∏î‡∏¢ TypeORM ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤
//üëâ ‚Äú‡∏ï‡∏≤‡∏£‡∏≤‡∏á flights ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‚Äù

// ===============================
// Import ‡∏à‡∏≤‡∏Å TypeORM (‡∏•‡πà‡∏≤‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ú‡∏°‡∏Å‡∏±‡∏ö DB)
// ===============================
import { 
  Entity,                 // ‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡πà‡∏≤ class ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô Entity (‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô DB) Entity = ‚Äú‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Äù
  PrimaryGeneratedColumn, // Primary Key (Auto Increment) = ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏£‡∏∞‡∏ö‡∏∏‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  Column,                 // ‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î column ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
  OneToMany,              // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÅ‡∏ö‡∏ö 1 ‚Üí ‡∏´‡∏•‡∏≤‡∏¢
  ManyToMany,             // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÅ‡∏ö‡∏ö ‡∏´‡∏•‡∏≤‡∏¢ ‚Üí ‡∏´‡∏•‡∏≤‡∏¢
  JoinTable,              // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏•‡∏≤‡∏á (Join Table)
  VersionColumn           // ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Optimistic Lock (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Race Condition)  VersionColumn     // ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Optimistic Lock (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Race Condition)
} from 'typeorm';

// Import Entity ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
import { Booking } from './booking.entity';
import { FlightAmenity } from './flight-amenity.entity';

// ===============================
// Flight Entity
// ===============================

// @Entity('flights')
// ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á class ‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠ flights ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
@Entity('flights')
export class Flight {

  // ===============================
  // Primary Key
  // ===============================

  // flight_id = Primary Key ‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á flights
  // Auto Generate ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  @PrimaryGeneratedColumn()
  flight_id: number;

  // ===============================
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô
  // ===============================

  // ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô ‡πÄ‡∏ä‡πà‡∏ô TG101
  @Column()
  flight_code: string;

  // ‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á
  @Column()
  origin: string;

  // ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
  @Column()
  destination: string;

  // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á
  // type: 'timestamp' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà + ‡πÄ‡∏ß‡∏•‡∏≤
  @Column({ type: 'timestamp' })
  travel_date: Date;

  // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏±‡πã‡∏ß
  @Column()
  price: number;

  // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
  @Column()
  available_seats: number;

  // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô (Active / Cancelled ‡∏Ø‡∏•‡∏Ø)
  // default = Active
  @Column({ default: 'Active' })
  status: string;

  // ===============================
  // Version Column (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)
  // ===============================

  // ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Optimistic Locking
  // ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• flight ‡∏ñ‡∏π‡∏Å update
  // ‡∏Ñ‡πà‡∏≤ version ‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  // ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Race Condition
  @VersionColumn()
  version: number;

  // ===============================
  // Relations
  // ===============================

  // One-to-Many
  // 1 ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢ Booking
  @OneToMany(() => Booking, (booking) => booking.flight)
  bookings: Booking[];

  // Many-to-Many
  // 1 ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô ‡∏°‡∏µ Amenities ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á 
  // ‡πÅ‡∏•‡∏∞ 1 Amenity ‡∏Å‡πá‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô‡πÑ‡∏î‡πâ
  // (Amenities ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô 1 ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô Wi-Fi, Meal, USB Charging)
  @ManyToMany(() => FlightAmenity, { eager: false })

  // JoinTable = ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Flight ‚Üî Amenity
  @JoinTable({
    name: 'flight_amenity_mapping', // ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏•‡∏≤‡∏á
    joinColumn: { 
      name: 'flight_id',             // FK ‡∏ù‡∏±‡πà‡∏á Flight
      referencedColumnName: 'flight_id'
    },
    inverseJoinColumn: { 
      name: 'amenity_id',            // FK ‡∏ù‡∏±‡πà‡∏á Amenity
      referencedColumnName: 'amenity_id'
    }
  })
  amenities: FlightAmenity[];
}
